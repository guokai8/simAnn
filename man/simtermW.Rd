% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_with.R
\name{simtermW}
\alias{simtermW}
\title{Calculate semantic similarity between terms with optional term restriction and background
Calculate Weighted Semantic Similarity Between Terms}
\usage{
simtermW(tree, terms, new_annot, use_background = FALSE, ...)
}
\arguments{
\item{tree}{An OntologyTree object containing the ontology structure and annotations.}

\item{terms}{Character vector of terms between which to calculate similarity.}

\item{new_annot}{Either a named list mapping terms to gene sets, or a data frame 
containing Term and GeneID columns from enrichment analysis.}

\item{use_background}{Logical indicating whether to use original annotations from
the ontology tree. Default is FALSE.}

\item{...}{Additional parameters passed to internal functions.}

\item{method}{Character string specifying the similarity calculation method:
\describe{
  \item{term}{Term overlap based methods using gene set comparison}
  \item{ic}{Universal information content using term specificity}
  \item{resnik}{Resnik's information content based similarity
                (\doi{10.1613/jair.514}, \doi{10.1186/1471-2105-9-S5-S4})}
  \item{lin}{Lin's semantic similarity (\doi{10.5555/645527.657297})}
  \item{faith}{FaITH semantic similarity (\doi{10.1007/978-3-642-17746-0_39})}
  \item{rel}{Relevance similarity (\doi{10.1186/1471-2105-7-302})}
  \item{simic}{SimIC similarity (\doi{10.48550/arXiv.1001.0958})}
  \item{gogo}{GOGO similarity (\doi{10.1038/s41598-018-33219-y})}
  \item{wang}{Wang's semantic similarity (\doi{10.1093/bioinformatics/btm087})}
  \item{anc}{Ancestor based similarity using common ancestors}
}}

\item{ic_method}{Character string specifying IC calculation method for 
       faith, rel, and simic methods:
\describe{
  \item{universal}{Universal-based IC using term frequencies}
  \item{annotation}{Annotation-based IC using gene annotations}
  \item{wang}{Wang's IC calculation method}
  \item{offspring}{Offspring-based IC using term descendants}
}}

\item{submethod}{For "term" method, specifies the set similarity measure:
\describe{
  \item{kappa}{Cohen's kappa coefficient for categorical agreement}
  \item{overlap}{Overlap coefficient: |A∩B| / min(|A|,|B|)}
  \item{jaccard}{Jaccard similarity: |A∩B| / |A∪B|}
  \item{dice}{Dice coefficient: 2|A∩B| / (|A|+|B|)}
}}

\item{normType}{For Resnik similarity, specifies normalization method:
\describe{
  \item{unif}{Normalize by log of maximum annotation count}
  \item{max}{Normalize by maximum IC value}
  \item{sum}{Normalize by maximum pairwise IC}
  \item{none}{No normalization}
}}

\item{weights}{Named numeric vector of weights for edge types in GOGO/Wang methods.
Names must match relation types (e.g., "is_a", "part_of"), values should be < 1.}

\item{useIgraph}{Logical indicating whether to use igraph package for calculations.
Recommended for large graphs. Default is FALSE.}

\item{useCache}{Logical indicating whether to use cached IC values when applicable.
Default is TRUE.}

\item{verbose}{Logical indicating whether to print progress messages.
Default is FALSE.}
}
\value{
A matrix of pairwise semantic similarity scores between terms.

Term clusters object
}
\description{
A unified interface for calculating semantic similarity between ontology terms using
various established methods with support for weighted relationships. The function supports
multiple similarity calculation approaches including term overlap, information content
based methods, and graph-based methods. It can work with both standard GO annotations
and custom gene sets.
}
\details{
The function implements several semantic similarity calculation methods with weighted
edge support:
\itemize{
  \item Term-based methods use direct comparison of gene sets
  \item Information Content (IC) based methods use the specificity of terms
  \item Graph-based methods use the ontology structure with edge weights
  \item Hybrid methods combine multiple approaches
}
}
\examples{
# Load example data
data(goTree)

# Define edge weights
weights <- c("is_a" = 0.8, "part_of" = 0.6)


# Example 1: Using custom gene sets
geneset <- list(
  "GO:0000086" = c("TAF2", "FOXM1", "RRM1", "ATR"),
  "GO:0000422" = c("LRBA", "EIF2AK1", "SPATA18"),
  "GO:0001678" = c("SYBU", "KCNB1", "PLA2G6", "LIN28A")
)
sim2 <- simtermW(goTree$human, names(geneset), 
                 new_annot = geneset,
                 method = "wang",
                 weights = weights)

# Example 2: Using enrichment results
\dontrun{
# Assuming 'enrich_res' is from enrichment analysis
sim3 <- simtermW(goTree$human, 
                 enrich_res$Term,
                 new_annot = enrich_res,
                 method = "resnik",
                 normType = "max",
                 weights = weights)
}

}
\references{
\itemize{
  \item Resnik P (1995). Using information content to evaluate semantic similarity in a taxonomy.
  \item Lin D (1998). An information-theoretic definition of similarity.
  \item Wang JZ, et al (2007). A new method to measure the semantic similarity of GO terms.
  \item Yang H, et al (2012). GOGO: An improved algorithm to measure the semantic similarity.
}
}
\seealso{
\code{\link{simterm}} for calculating semantic similarity between terms
}
\author{
Kai Guo
}
