% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/buildKEGG.R
\name{buildKEGGTree}
\alias{buildKEGGTree}
\title{Build KEGG Ontology Tree}
\usage{
buildKEGGTree(
  species = "ko",
  keytype = c("SYMBOL", "ENTREZID"),
  builtin = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{species}{Character string specifying the species:
\describe{
  \item{ko}{KEGG Orthology (default)}
  \item{human}{Human}
  \item{mouse}{Mouse}
  \item{rat}{Rat}
}}

\item{keytype}{Character string specifying the gene identifier type for human data:
\describe{
  \item{SYMBOL}{Gene symbols (default)}
  \item{ENTREZID}{Entrez gene IDs}
}}

\item{builtin}{Logical indicating whether to use prebuilt data for supported
species. Default: TRUE.}

\item{verbose}{Logical indicating whether to print progress messages.
Default: TRUE.}
}
\value{
An OntologyTree object containing:
\describe{
  \item{metadata}{Data frame with columns:
    \itemize{
      \item id: Unique identifier for each node
      \item name: Descriptive name of the node
      \item namespace: Ontology namespace information
    }
  }
  \item{annotations}{Leaf node annotations including:
    \itemize{
      \item GeneID: Enzyme K-code or gene ID
      \item Anno: Node annotation
      \item Level3: Level 3 pathway code
      \item Level3Anno: Level 3 pathway annotation
      \item Level2: Level 2 pathway code
      \item Level2Anno: Level 2 pathway annotation
      \item Level1: Level 1 pathway code
      \item Level1Anno: Level 1 pathway annotation
    }
  }
  \item{attributes}{Species information in format "<species>00001"}
}

OntologyTree object
}
\description{
Constructs a hierarchical ontology tree from KEGG BRITE data, either by loading
prebuilt data for supported species or by retrieving and parsing KEGG data
dynamically. The function handles the complex hierarchical structure of KEGG
pathways and creates a standardized ontology representation.
}
\details{
The function processes KEGG data in the following steps:

1. Data Source:
   * Uses prebuilt data for supported species if builtin=TRUE
   * Retrieves data via KEGGREST::keggGet using "br:<species>00001" format

2. Hierarchical Structure:
   * Parses KEGG BRITE hierarchy into a standardized format
   * Creates a data frame with consistent level information
   * Handles special cases and duplicates in KEGG pathways

3. Internal Adjustments:
\describe{
  \item{Drug Development}{Assigned code 09200}
  \item{Level2 Temporary Codes}{Uses codes like 09113, 09114}
  \item{Duplicate Handling}{
    * 541X: Biosynthesis of various nucleotide sugars
    * 541: O-Antigen nucleotide sugar biosynthesis
    * 710X: Carbon fixation by Calvin cycle
    * 710: Carbon fixation in photosynthetic organisms
    * 720X: Other carbon fixation pathways
    * 720: Carbon fixation pathways in prokaryotes
  }
}
}
\examples{
\dontrun{
# Build KEGG tree for general orthology
ko_tree <- buildKEGGTree()

# Build human KEGG tree with gene symbols
human_tree <- buildKEGGTree(
  species = "human",
  keytype = "SYMBOL",
  builtin = TRUE
)

# Build mouse KEGG tree with verbose output
mouse_tree <- buildKEGGTree(
  species = "mouse",
  builtin = TRUE,
  verbose = TRUE
)

# Build rat KEGG tree with downloaded data
rat_tree <- buildKEGGTree(
  species = "rat",
  builtin = FALSE,
  verbose = TRUE
)
}

}
\references{
Kanehisa, M., & Goto, S. (2000). KEGG: Kyoto Encyclopedia of Genes and Genomes.
Nucleic Acids Research, 28(1), 27-30.
}
\seealso{
\code{\link[KEGGREST]{keggGet}} for KEGG data retrieval
\code{\link{buildOntologyTree}} for ontology tree construction
}
\author{
Kai Guo
}
