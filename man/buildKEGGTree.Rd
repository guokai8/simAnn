% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/buildKEGG.R
\name{buildKEGGTree}
\alias{buildKEGGTree}
\title{Build KEGG Ontology Tree}
\usage{
buildKEGGTree(
  species = "ko",
  keytype = c("SYMBOL", "ENTREZID"),
  builtin = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{species}{A string specifying the species prefix (e.g., \code{"ko"} or \code{"hsa"}). Default is \code{"ko"}.}

\item{keytype}{For species \code{"hsa"}, a character vector specifying the gene identifier type. Allowed values
are \code{"SYMBOL"} and \code{"ENTREZID"}. The default is \code{"SYMBOL"}.}

\item{builtin}{Logical. If \code{TRUE} and \code{species} is one of the built-in types (\code{"human"},
\code{"mouse"}, \code{"rat"}, or \code{"ko"}), the function loads a prebuilt KEGG tree from
the built-in data. Default is \code{TRUE}.}

\item{verbose}{Logical. When \code{TRUE}, the function prints progress messages. Default is \code{TRUE}.}
}
\value{
An \code{OntologyTree} object. The object contains:
  \itemize{
    \item A \code{metadata} slot holding a data frame with columns \code{id}, \code{name}, and \code{namespace}.
    \item Leaf node annotation information stored in \code{tree@annotations}.
    \item An attribute on the metadata specifying the species (in the form \code{"<species>00001"}).
  }
}
\description{
This function retrieves KEGG BRITE data using \code{KEGGREST::keggGet} with a query of the form
\code{"br:<species>00001"}. The default species is \code{"ko"}. When the \code{builtin} parameter is
set to \code{TRUE} and the supplied \code{species} is one of \code{"human"}, \code{"mouse"},
\code{"macaca"}, \code{"rat"}, or \code{"ko"}, a prebuilt KEGG ontology tree is loaded from the
built-in data. Otherwise, the function downloads the KEGG BRITE data, parses its hierarchical structure,
and constructs the ontology tree.
}
\details{
The hierarchical structure is parsed into a data frame that includes the following columns:
\itemize{
  \item \code{GeneID} - the identifier of the leaf node (an enzyme K-code or gene ID),
  \item \code{Anno} - the annotation for the leaf node,
  \item \code{Level3} - the Level 3 code,
  \item \code{Level3Anno} - the Level 3 annotation,
  \item \code{Level2} - the Level 2 code,
  \item \code{Level2Anno} - the Level 2 annotation,
  \item \code{Level1} - the Level 1 code,
  \item \code{Level1Anno} - the Level 1 annotation.
}

Please note the following adjustments made for internal consistency:
\itemize{
  \item The KEGG code for Drug Development is designated as \code{09200}.
  \item Temporary codes were assigned to Level2 (e.g., \code{09113} and \code{09114} for temporary use).
  \item To resolve duplicate entries, the following modifications were applied:
    \item \code{541X} represents Biosynthesis of various nucleotide sugars,
    \item \code{541} represents O-Antigen nucleotide sugar biosynthesis,
    \item \code{710X} represents Carbon fixation by Calvin cycle,
    \item \code{710} represents Carbon fixation in photosynthetic organisms,
    \item \code{720X} represents Other carbon fixation pathways, and
    \code{720} represents Carbon fixation pathways in prokaryotes.
}

The function then calls the existing \code{buildOntologyTree()} function (which expects a data frame
with columns \code{"GeneID"}, \code{"Level3"}, \code{"Level2"}, and \code{"Level1"}) to construct the
final \code{OntologyTree} object.

Metadata is generated solely from the level information (Levels A, B, and C) and is stored as a data frame
with columns \code{id}, \code{name}, and \code{namespace}. (Leaf node data, including the K-codes or gene IDs,
do not appear in the metadata; their annotations are maintained in the \code{tree@annotations} slot.)

Finally, the species information is appended as an attribute to the metadata.
}
