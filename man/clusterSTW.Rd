% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cluster_with.R
\name{clusterSTW}
\alias{clusterSTW}
\title{Cluster Similar Terms with Wang's Method and Weighted Edges}
\usage{
clusterSTW(
  tree,
  terms,
  new_annot,
  method = c("term", "ic", "resnik", "lin", "faith", "rel", "simic", "gogo", "wang",
    "anc"),
  threshold = 0.5,
  ic_method = c("annotation", "universal", "wang", "offspring"),
  submethod = c("kappa", "overlap", "jaccard", "dice"),
  normType = "max",
  weights = NULL,
  annotUniverse = NULL,
  useCache = TRUE,
  useIgraph = TRUE,
  verbose = TRUE,
  use_background = FALSE,
  ...
)
}
\arguments{
\item{tree}{An OntologyTree object containing the Gene Ontology hierarchy.}

\item{terms}{Character vector of GO terms to analyze.}

\item{new_annot}{Either a named list of gene sets per term, or a data frame 
containing enrichment results with Term and GeneID columns.}

\item{method}{Character string specifying the similarity calculation method:
\describe{
  \item{term}{Term overlap based methods (kappa, overlap, jaccard, dice)}
  \item{ic}{Universal information content}
  \item{resnik}{Resnik's semantic similarity}
  \item{lin}{Lin's semantic similarity}
  \item{faith}{FaITH semantic similarity}
  \item{rel}{Relevance similarity}
  \item{simic}{SimIC similarity}
  \item{wang}{Wang's semantic similarity method}
  \item{anc}{Ancestor-based similarity}
}}

\item{ic_method}{Character string specifying IC calculation method for faith/rel/simic:
\describe{
  \item{universal}{Universal-based Information Content}
  \item{annotation}{Annotation-based Information Content}
  \item{wang}{Wang's Information Content}
  \item{offspring}{Offspring-based Information Content}
}}

\item{submethod}{For "term" method, specifies similarity coefficient:
\describe{
  \item{kappa}{Cohen's kappa coefficient}
  \item{overlap}{Overlap coefficient}
  \item{jaccard}{Jaccard similarity}
  \item{dice}{Dice coefficient}
}}

\item{normType}{For Resnik similarity, specifies normalization:
\describe{
  \item{unif}{By log of max annotation count}
  \item{max}{By maximum IC value}
  \item{sum}{By maximum pairwise IC}
  \item{none}{No normalization}
}}

\item{weights}{Named numeric vector of weights for edge types (e.g., is_a, part_of).
Values should be < 1.}

\item{useCache}{Logical. Whether to use cached IC values.}

\item{useIgraph}{Logical. Whether to use igraph-based calculation.}

\item{verbose}{Logical. Whether to print progress messages.}

\item{use_background}{Logical. Whether to use original annotations from the ontology.}

\item{...}{Additional parameters passed to underlying clustering function.}
}
\value{
A term clusters object containing the clustering results.
}
\description{
This function clusters similar terms using Wang's semantic similarity method,
supporting weighted edge types in the ontology graph. It can analyze either
direct gene sets or enrichment analysis results.
}
\examples{
# Example 1: Using gene sets
# Define edge weights
weights <- c("is_a" = 0.8, "part_of" = 0.6)

# Define gene sets
geneset <- list(
  "GO:0000086" = c("TAF2", "FOXM1", "RRM1", "ATR"),
  "GO:0000422" = c("LRBA", "EIF2AK1", "SPATA18"),
  "GO:0001678" = c("SYBU", "KCNB1", "PLA2G6", "LIN28A"),
  "GO:0001704" = c("SNAI1", "GPI", "AHDC1"),
  "GO:0006282" = c("TAF2", "FOXM1", "BRD8", "ATR", "PARPBP")
)

# Cluster terms using Wang's method
clu <- clusterSTW(tree, 
                  terms = names(geneset),
                  new_annot = geneset,
                  method = "wang",
                  weights = weights,
                  threshold = 0.2)

# Example 2: Using enrichment results
# Assuming 'res' is enrichment results from richR
\dontrun{
clu <- clusterSTW(tree,
                  terms = res$Annot,
                  new_annot = as.data.frame(res),
                  method = "wang",
                  weights = weights,
                  threshold = 0.2)
}

}
\references{
Wang et al. (2007) A new method to measure the semantic similarity of GO terms.
Bioinformatics, 23(10):1274-1281. \doi{10.1093/bioinformatics/btm087}
}
\seealso{
\code{\link{clusterST}} for basic term clustering
}
\author{
Kai Guo
}
